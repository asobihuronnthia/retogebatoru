<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ãƒ¬ãƒˆãƒ­ã‚²ãƒ¼ãƒ ãƒ‡ã‚¤ãƒªãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãã˜</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 600px; margin: 2em auto; padding: 1em; background:#f9f9f9; }
  button { font-size: 1.2em; padding: 0.5em 1em; margin: 1em 0; }
  #mission { margin: 1em 0; font-size: 1.3em; background: #fff; padding: 1em; border-radius: 8px; box-shadow: 0 0 5px #ccc; }
  #points { font-weight: bold; margin-top: 1em; }
  #message { margin-top: 1em; font-size: 1.2em; color: green; }
  #uploadedImage { max-width: 100%; margin-top: 1em; border-radius: 8px; }
</style>
</head>
<body>

<h1>ãƒ¬ãƒˆãƒ­ã‚²ãƒ¼ãƒ ãƒ‡ã‚¤ãƒªãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ãã˜</h1>

<button id="drawBtn">ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’å¼•ã</button>

<div id="mission">ã“ã“ã«ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>

<form id="uploadForm">
  <label>é”æˆç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒã‚¤ãƒ³ãƒˆGETï¼</label><br />
  <input type="file" accept="image/*" id="imageInput" required />
  <button type="submit">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</button>
</form>

<div id="points">ç¾åœ¨ã®ãƒã‚¤ãƒ³ãƒˆ: 0</div>
<div id="message"></div>
<img id="uploadedImage" alt="" />

<script>
  const missions = [
    "ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ã®ãƒ‡ãƒ¢ã‚’æœ€å¾Œã¾ã§è¦‹ã‚‹",
    "ã‚²ãƒ¼ãƒ èµ·å‹•å¾Œã€ç„¡æ“ä½œã§30ç§’æ”¾ç½®",
    "æ•µã«1å›ã ã‘ã‚ã–ã¨æ¥è§¦ã—ã¦ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ã‚‹",
    "ãƒãƒ¼ã‚ºç”»é¢ã‚’3å›é–‹ã",
    "1ã‚¹ãƒ†ãƒ¼ã‚¸ã®é–‹å§‹ã‹ã‚‰1åˆ†é–“ã€ã‚¸ãƒ£ãƒ³ãƒ—ã ã‘ã§éŠã¶",
    "ç”»é¢ã®éš…ã£ã“ã§30ç§’ã˜ã£ã¨ã™ã‚‹",
    "ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢ã‚’1å›è¦‹ã‚‹",
    "ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’3å›é€£ç¶šã§æŠ¼ã™",
    "å–ã‚Œã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®ã†ã¡ã€1ã¤ã ã‘å–ã‚‹",
    "ãƒãƒ¼ã‚ºâ†’å†é–‹ã‚’5å›ç¹°ã‚Šè¿”ã™"
  ];

  const drawBtn = document.getElementById('drawBtn');
  const missionDiv = document.getElementById('mission');
  const uploadForm = document.getElementById('uploadForm');
  const imageInput = document.getElementById('imageInput');
  const pointsDiv = document.getElementById('points');
  const messageDiv = document.getElementById('message');
  const uploadedImage = document.getElementById('uploadedImage');

  // ãƒã‚¤ãƒ³ãƒˆã¯localStorageã«ä¿å­˜ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶å†…ã®ã¿ï¼‰
  function getPoints() {
    return Number(localStorage.getItem('points') || '0');
  }
  function setPoints(p) {
    localStorage.setItem('points', p);
    pointsDiv.textContent = `ç¾åœ¨ã®ãƒã‚¤ãƒ³ãƒˆ: ${p}`;
  }

  // åˆæœŸãƒã‚¤ãƒ³ãƒˆè¡¨ç¤º
  setPoints(getPoints());

  // ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¡¨ç¤º
  drawBtn.onclick = () => {
    const idx = Math.floor(Math.random() * missions.length);
    missionDiv.textContent = `ğŸ¯ ãƒŸãƒƒã‚·ãƒ§ãƒ³: ${missions[idx]}`;
    messageDiv.textContent = '';
    uploadedImage.src = '';
    imageInput.value = '';
  };

  // ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãƒã‚¤ãƒ³ãƒˆåŠ ç®—
  uploadForm.onsubmit = (e) => {
    e.preventDefault();
    const file = imageInput.files[0];
    if (!file) {
      alert('ç”»åƒã‚’é¸ã‚“ã§ãã ã•ã„');
      return;
    }
    const reader = new FileReader();
    reader.onload = () => {
      uploadedImage.src = reader.result;
      // ãƒã‚¤ãƒ³ãƒˆåŠ ç®—
      let pts = getPoints();
      pts++;
      setPoints(pts);
      if (pts >= 5) {
        messageDiv.textContent = 'ğŸ‰ ãŠã‚ã§ã¨ã†ï¼ãƒã‚¤ãƒ³ãƒˆãŒ5ã‚’è¶…ãˆã¾ã—ãŸï¼';
      } else {
        messageDiv.textContent = `ãƒã‚¤ãƒ³ãƒˆãŒ1å¢—ãˆã¾ã—ãŸï¼ã‚ã¨${5 - pts}ã§ãŠç¥ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã™ã€‚`;
      }
    };
    reader.readAsDataURL(file);
  };
</script>

</body>
</html>